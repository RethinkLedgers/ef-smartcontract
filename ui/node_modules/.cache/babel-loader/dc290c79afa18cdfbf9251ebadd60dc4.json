{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\bartc\\\\Documents\\\\Github\\\\EF\\\\ef-app\\\\ui\\\\src\\\\components\\\\App.tsx\";\nimport React, { useEffect } from \"react\";\nimport { HashRouter, Route, Switch, Redirect } from \"react-router-dom\";\nimport { damlPartyKey, damlTokenKey } from \"../config\";\nimport { useUserState, useUserDispatch } from \"../context/UserContext\";\nimport Layout from \"./Layout/Layout\";\nimport ErrorComponent from \"../pages/error/Error\";\nimport Login from \"../pages/login/Login\";\nexport default function App() {\n  const userState = useUserState();\n  return /*#__PURE__*/React.createElement(HashRouter, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 13,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Switch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 14,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/\",\n    component: RootRoute,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 15,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/app\",\n    render: () => /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/app/mainscreen\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 19,\n        columnNumber: 25\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 16,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(PrivateRoute, {\n    path: \"/app\",\n    component: Layout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 21,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(PublicRoute, {\n    path: \"/login\",\n    component: Login,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 22,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    component: ErrorComponent,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 9\n    }\n  }))); // #######################################################################\n\n  function RootRoute() {\n    const userDispatch = useUserDispatch();\n    useEffect(() => {\n      const url = new URL(window.location.toString());\n      const token = url.searchParams.get('token');\n\n      if (token === null) {\n        return;\n      }\n\n      const party = url.searchParams.get('party');\n\n      if (party === null) {\n        throw Error(\"When 'token' is passed via URL, 'party' must be passed too.\");\n      }\n\n      localStorage.setItem(damlPartyKey, party);\n      localStorage.setItem(damlTokenKey, token);\n      userDispatch({\n        type: \"LOGIN_SUCCESS\",\n        token,\n        party\n      });\n    });\n    return /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/app/mainscreen\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 7\n      }\n    });\n  }\n\n  function PrivateRoute({\n    component,\n    ...rest\n  }) {\n    return /*#__PURE__*/React.createElement(Route, Object.assign({}, rest, {\n      render: props => userState.isAuthenticated ? React.createElement(component, props) : /*#__PURE__*/React.createElement(Redirect, {\n        to: {\n          pathname: \"/login\",\n          state: {\n            from: props.location\n          }\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 13\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 7\n      }\n    }));\n  }\n\n  function PublicRoute({\n    component,\n    ...rest\n  }) {\n    return /*#__PURE__*/React.createElement(Route, Object.assign({}, rest, {\n      render: props => userState.isAuthenticated ? /*#__PURE__*/React.createElement(Redirect, {\n        to: {\n          pathname: \"/\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 13\n        }\n      }) : React.createElement(component, props),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 7\n      }\n    }));\n  }\n}","map":{"version":3,"sources":["C:/Users/bartc/Documents/Github/EF/ef-app/ui/src/components/App.tsx"],"names":["React","useEffect","HashRouter","Route","Switch","Redirect","damlPartyKey","damlTokenKey","useUserState","useUserDispatch","Layout","ErrorComponent","Login","App","userState","RootRoute","userDispatch","url","URL","window","location","toString","token","searchParams","get","party","Error","localStorage","setItem","type","PrivateRoute","component","rest","props","isAuthenticated","createElement","pathname","state","from","PublicRoute"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\nimport { HashRouter, Route, Switch, Redirect } from \"react-router-dom\";\nimport { damlPartyKey, damlTokenKey } from \"../config\";\nimport { useUserState, useUserDispatch } from \"../context/UserContext\";\nimport  Layout   from \"./Layout/Layout\";\nimport ErrorComponent from \"../pages/error/Error\";\nimport Login from \"../pages/login/Login\";\n\nexport default function App() {\n  const userState = useUserState();\n\n  return (\n    <HashRouter>\n      <Switch>\n        <Route exact path=\"/\" component={RootRoute} />\n        <Route\n          exact\n          path=\"/app\"\n          render={() => <Redirect to=\"/app/mainscreen\" />}\n        />\n        <PrivateRoute path=\"/app\" component={Layout} />\n        <PublicRoute path=\"/login\" component={Login} />\n        <Route component={ErrorComponent} />\n      </Switch>\n    </HashRouter>\n  );\n\n  // #######################################################################\n\n  function RootRoute() {\n    const userDispatch = useUserDispatch();\n\n    useEffect(() => {\n      const url = new URL(window.location.toString());\n      const token = url.searchParams.get('token');\n      if (token === null) {\n        return;\n      }\n      const party = url.searchParams.get('party');\n      if (party === null) {\n        throw Error(\"When 'token' is passed via URL, 'party' must be passed too.\");\n      }\n      localStorage.setItem(damlPartyKey, party);\n      localStorage.setItem(damlTokenKey, token);\n\n      userDispatch({ type: \"LOGIN_SUCCESS\", token, party });\n    })\n\n    return (\n      <Redirect to=\"/app/mainscreen\" />\n    )\n  }\n\n  function PrivateRoute({ component, ...rest } : any) {\n    return (\n      <Route\n        {...rest}\n        render={props =>\n          userState.isAuthenticated ? (\n            React.createElement(component, props)\n          ) : (\n            <Redirect\n              to={{\n                pathname: \"/login\",\n                state: {\n                  from: props.location,\n                },\n              }}\n            />\n          )\n        }\n      />\n    );\n  }\n\n  function PublicRoute({ component, ...rest } : any) {\n    return (\n      <Route\n        {...rest}\n        render={props =>\n          userState.isAuthenticated ? (\n            <Redirect\n              to={{\n                pathname: \"/\",\n              }}\n            />\n          ) : (\n            React.createElement(component, props)\n          )\n        }\n      />\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}